<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="PureBuilder Simply WP Importer" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
    <meta name="author" content="Masaki Haruka" />
    <meta name="date" content="2014-10-20T00:00:00+09:00" />
    <meta name="dcterms.date" content="2014-10-20T00:00:00+09:00" />
    <title>ReasonSet サイト構築システム PureBuilder - Chienomi</title>
    <style type="text/css">article {
max-width: 1080px;
margin: auto;
}</style>
  </head>
  <body>

    <section id="ContentContainer">
      <header id="MainHeader"><a href="/"><h1>Chienomi</h1></a></header>
      <section id="ArticleBox">
        <header id="ArticleTitle"><h1>ReasonSet サイト構築システム PureBuilder</h1></header>
        <article id="MainArticle">
<p>PureBuilderは以前から何度か登場し、完全にやり直し、と繰り返している。今回は、「本体スクリプト」というものがない状態で登場し、ついに実用となった。</p><p>まず下地となるPureBuilderだが、<a href="https://github.com/reasonset/reasondoc" alt="かなり更新され、GitHubにも既に反映されている">かなり更新され、GitHubにも既に反映されている</a>。まずこれがベースになる。</p><p>そして、「PureDocを使った翻訳を自動化する」というのがPureBuilderの基本的なところだ。<a href="https://github.com/reasonset/purebuilder" alt="PureBuilderのGitHub">PureBuilderのGitHub</a>にある<tt class="puredoc_pathname">purebuild-puredoc.zsh</tt>がその根幹となるスクリプトである。</p><p>はっきり言ってGitHubにある設定ファイルのサンプルとREADMEを読むのが一番早いと思うのだが、つまりこのスクリプトは<tt class="puredoc_pathname">.purebuild-puredoc.rc</tt>, <tt class="puredoc_pathname">.up_*</tt>, <tt class="puredoc_pathname">.rebuild-rules</tt>ファイルに従って実行するための補助ユーティリティでしかない。だが、設定ファイルを適切に書くことでほぼ全面的な自動化を実現している。サンプルをみれば分かるように、メニューを動的生成していたりする(eRubyを使っている)ため、サイトでユーザーからのアクションが自動的に反映されるような仕組みを持たないドキュメントに関してはこの方法で動的に静的ドキュメントを生成することができる。これは、著しいオーバーヘッド削減につながる。</p><p>参考までに、ReasonSetのサイトのメニューの構築を行うテンプレートは次のようなものだ。</p><code style="display: block;white-space: pre-wrap">&lt;% menu = [ 
           [ ["ReasonSet / Help", "//reasonset.net/", "ReasonSet全体の情報"], (ENV["SITETYPE"] == "REASONSET"), [["Profile", "//reasonset.net/profile.html", "正木はるか（柊美亜紀）のプロフィール"]] ],
           [ ["HARUKA Sound", nil, "音楽プロダクション/プロジェクト HARUKA Soundの公式ページ（お仕事）"], nil, [] ],
           [ ["Aki's palace", nil, "正木はるか（柊美亜紀）に関するウェブサイト。本人について、意見など"], (ENV["SITETYPE"] == "AKI"), [ ["Talkin' about", nil, "様々なテーマに対しそのフィルタを通して語る" ] ] ],
           [ ["ちぇのみ-Chienomi-", nil, "コンピュータ"] , (ENV["SITETYPE"] == "CHIENOMI"), ["COLUMN", nil, "コラム" ], ["+Play programming with JavaScript", nil, "JavaScriptでプログラミングを遊ぶ"] ["+Easy step programming with Perl", nil, "Perlではじめるプログラミング入門"], ["+Easy step object oriented programming with Ruby", nil, "Rubyではじめるオブジェクト指向入門"] , ["Live with Linux", "http://reasonset.net/journal/archives/category/livewithlinux", "Linux日記" ] ],
           [ ["Feel the Earth", nil, "バイク"], (ENV["SITETYPE"] == "MOTO"), [["Impression",nil,"所有車両のインプレッション"], ["Impression:HONDA VT250J SPADA", nil], ["Impression: SUZUKI SV400S", nil], ["Impression:YAMAHA MT-09", nil], ["Column", nil, "コラム"] ] ],
           [ ["Blogs", "//reasonset.net/blog.html", "ブログ"], (ENV["SITETYPE"] == "BLOG") , [["journal de Aki", "http://reasonset.net/journal/", "本来のブログ"], ["Ameblo", "http://ameblo.jp/reasonset", "くだらないブログ"]] ],
           [ ["SI Service", "http://reasonset.net/si/", "コンピュータの技術を供与するサービスについて（お仕事）"], nil, [] ]
         ]
%&gt;

    &lt;div id="ReasonsetMenu"&gt;
% menu.each do | name, cond, items |
%   if name[1]
      &lt;div class="menu_title"&gt;&lt;a href="&lt;%= name[1] %&gt;" title="&lt;%= name[2] %&gt;"&gt;&lt;%= name[0] %&gt;&lt;/a&gt;&lt;/div&gt;
%   else
      &lt;div class="menu_title"&gt;&lt;span  title="&lt;%= name[2] %&gt;"&gt;&lt;%= name[0] %&gt;&lt;/span&gt;&lt;/div&gt;
%   end
% items.each do |i|
%   if i[1]
        &lt;div class="menu_item"&gt;&lt;a href="&lt;%= i[1] %&gt;" title="&lt;%= i[2] %&gt;"&gt;&lt;%= i[0] %&gt;&lt;/a&gt;&lt;/div&gt;
%   else
        &lt;div class="menu_item"&gt;&lt;span title="&lt;%= i[2] %&gt;"&gt;&lt;%= i[0] %&gt;&lt;/span&gt;&lt;/div&gt;
%   end
% end if cond
% end
    &lt;/div&gt;
</code><p>さらに、よりプロフィールに関してはプロフィール自体がRuby scriptとなっており、それを実行することでPureDocを拡張した形式で書かれたプロフィールを展開する。</p><p>もっとも、プロフィールを含むスクリプトはあくまで出力するだけであり、実際にアップロードする処理は<tt class="puredoc_pathname">.up_profile</tt>というスクリプトを書いて実行している。</p><p>全体には伝播する環境変数をうまくつかった仕組みになっていると思う。</p>
<!-- PBSEARCH_RESULT -->
        </article>
    </section>
    <footer id="InfoFooter">
      <ul>
        <li>© Masaki Haruka 2003.</li>
        <li>Generated by <a href="https://gitlab.com/reasonset/pbsimply-wpimporter">PureBuilder Simply WP Importer</a></li>
      </ul>
    </footer>
  </body>
</html>
