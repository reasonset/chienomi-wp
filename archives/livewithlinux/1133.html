<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="PureBuilder Simply WP Importer" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
    <meta name="author" content="Masaki Haruka" />
    <meta name="date" content="2017-10-11T00:00:00+09:00" />
    <meta name="dcterms.date" content="2017-10-11T00:00:00+09:00" />
    <title>Git/Mercurialを使いデスクトップとラップトップで作業する - Chienomi</title>
    <style type="text/css">article {
max-width: 1080px;
margin: auto;
}</style>
  </head>
  <body>

    <section id="ContentContainer">
      <header id="MainHeader"><a href="/"><h1>Chienomi</h1></a></header>
      <section id="ArticleBox">
        <header id="ArticleTitle"><h1>Git/Mercurialを使いデスクトップとラップトップで作業する</h1></header>
        <article id="MainArticle">
<p>GitやMercurialでの分散作業というのは、高度なユーザーやギークばかりでなく、多くの人にとってメリットのある手法だ。 デスクトップを母艦としてラップトップを使う人にとっては確実に意味のあることだろう。</p>
<h3 id="基本的な話">基本的な話</h3>
<p>まずいまいちど基本的な手法を確認しよう。 まず、基本となるリポジトリを作る。</p>
<p>Gitの場合</p>
<pre><code>$ cd ~/Repositories/Myrepo.git
$ git init --bare
$ cd ~/Work
$ git clone ~/Repositories/Myrepo.git</code></pre>
<p>Mercurialの場合yvarn</p>
<pre class="t"><code></code></pre>
<p>この違いは、Gitがワーキングツリーを持つリポジトリに対する同期を非推奨としていることによる。 そのため、同期するためにはベアリポジトリを作り、その上でワーキングリポジトリとしてcloneする必要があるのだ。</p>
<p>Mercurialの場合は特にそのような必要はなく、ワーキングツリーを持つリポジトリをcloneすれば分散作業できる。</p>
<p>ここでは話を楽にするためにMercurialを使おう。</p>
<p>デスクトップコンピュータの<code>dragon.local</code>ホストの<code>~/Work/Wyvarn</code>リポジトリを作ったとする。 この作業を外で続けたくなったので、ラップトップ(<code>knight.local</code>)でこのリポジトリをcloneする。</p>
<pre><code>$ cd ~/Work
$ hg clone ssh://jrh@dragon.local/Work/Wyvarn</code></pre>
<p>Mercurialのsshアクセスはパス部が相対パスで始まっているものとみなすので注意してほしい。絶対パスで指定するためにはパス部を<code>/</code>ではじめる必要がある。</p>
<p>過酷な作業を終え、充実の成果をあげた。では家に帰ってその成果を反映しよう。</p>
<pre><code>$ cd ~/Work/Wyvarn
$ hg push</code></pre>
<p>続きはデスクトップで。デスクトップでリポジトリのアップデートを反映する。</p>
<pre><code>$ cd ~/Work/Wyvarn
$ hg update</code></pre>
<h3 id="変更に強い構成にする">変更に強い構成にする</h3>
<p>だが、実のところこのようなシステムではファイルの配置が変わったり、ファイル名が変わったり、ホスト名が変わったりするのはよくあることだ。 そのたびにすべてのリポジトリを修正するのはかなりの手間がかかる。</p>
<p>これにはふたつの抽象化レイヤーの導入が有効だ。</p>
<p>まずは、ホスト名を、そのホストに依存したものではなく、専用の固定名を与える。 ホストが少ないのであれば<code>/etc/hosts</code>ファイルで良いだろう。</p>
<pre><code>192.168.2.100          repo</code></pre>
<p>多いのであれば、dnsmasqを使うと良い。</p>
<p>続いてリポジトリへのパスを抽象化しよう。 これは、次のようにするといい。</p>
<pre><code># mount --bind ~jrh/Repositories /mnt/repo</code></pre>
<p>その上で</p>
<pre><code>/home/jrh/Work/Wyvarn -&gt; /home/jrh/Repositories/Wyvarn</code></pre>
<p>のような状態にしておけばいいだろう(実体の位置を間違えないように)。</p>
<p>そして、ラップトップでは</p>
<pre><code>$ hg clone ssh://jrh@repo//mnt/repo/Wyvarn</code></pre>
<p>のようにすればいい。</p>

<!-- PBSEARCH_RESULT -->
        </article>
    </section>
    <footer id="InfoFooter">
      <ul>
        <li>© Masaki Haruka 2003.</li>
        <li>Generated by <a href="https://gitlab.com/reasonset/pbsimply-wpimporter">PureBuilder Simply WP Importer</a></li>
      </ul>
    </footer>
  </body>
</html>
