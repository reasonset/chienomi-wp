<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="PureBuilder Simply WP Importer" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
    <meta name="author" content="Masaki Haruka" />
    <meta name="date" content="2014-11-07T00:00:00+09:00" />
    <meta name="dcterms.date" content="2014-11-07T00:00:00+09:00" />
    <title>FontConfig, Zsh compilation, Zsh prompt - Chienomi</title>
    <style type="text/css">article {
max-width: 1080px;
margin: auto;
}</style>
  </head>
  <body>

    <section id="ContentContainer">
      <header id="MainHeader"><a href="/"><h1>Chienomi</h1></a></header>
      <section id="ArticleBox">
        <header id="ArticleTitle"><h1>FontConfig, Zsh compilation, Zsh prompt</h1></header>
        <article id="MainArticle">
<h3>FontConfig</h3><p>うまく動かないといっていたlocal.conf及びUser configだが、どうも<tt class="puredoc_pathname">/etc/fonts/conf.d/</tt>のリンクをmvして戻すと有効になるようだ。理由はわからず、競合するリンクを削除しても変わらない。</p><p>また、それでもなぜかUserに対してのserifだけが適用されない。謎だ。</p><h3>Zsh Compilation</h3><p>以下の設定を追加してみた。</p><samp style="display: block;white-space: pre-wrap"># Complation options
setopt auto_menu
setopt glob_complete
setopt auto_list
setopt list_beep
setopt list_types
setopt rec_exact
</samp><tt class="puredoc_idname">menu_complete</tt><p><tt class="puredoc_idname">menu_complete</tt>は使いにくかったのでやめた。</p><h3>Zsh Prompt</h3><p>Momonga Linuxのzshrcサンプルを流用していて、これが結構いかしたプロンプトなのだが、Manjaroのetc版と比べてGitが有効になっていないので、有効にすると同時にちょっといじってみた。</p><p><a href="http://yoshiko.hatenablog.jp/entry/2014/04/02/zshのプロンプトにgitのステータスをシンプル可愛く" alt="zshのプロンプトにgitのステータスをシンプル可愛く">zshのプロンプトにgitのステータスをシンプル可愛く</a>を参考にしたのだが、これをそのまま追加すると<tt class="puredoc_idname">RPROMPT</tt>と競合してしまう。どうやら、プロンプトの設定自体を動的に行うと<tt class="puredoc_idname">RPROMPT</tt>の文字数が計算できなくなるようだ。</p><p><tt class="puredoc_idname">RPROMPT</tt>込みで流用できるのは<tt class="puredoc_idname">きたけーさんのブログ</tt>だが、これだと情報量が少ない。</p><p>そこでこれを合体させ、さらに色使いを変更し、終了ステータスで変更するのをプロンプト全体ではなくプロンプト(<tt class="puredoc_idname">$</tt>)のみにした。</p><samp style="display: block;white-space: pre-wrap">## prompt
# USER --&gt;
# For git. I referred http://kitak.hatenablog.jp/entry/2013/05/25/103059 and http://yoshiko.hatenablog.jp/entry/2014/04/02/zshのプロンプトにgitのステータスをシンプル可愛く. Thank you.
# VCSの情報を取得するzshの便利関数 vcs_infoを使う
autoload -Uz vcs_info

# 表示フォーマットの指定
# %b ブランチ情報
# %a アクション名(mergeなど)
zstyle ':vcs_info:*' formats '[%b]'
zstyle ':vcs_info:*' actionformats '[%b|%a]'
precmd () {
    psvar=()
    LANG=en_US.UTF-8 vcs_info
    if [[ -n "$vcs_info_msg_0_" ]]
    then
      psvar[1]="$vcs_info_msg_0_"
      if   [[ -n "$vcs_info_msg_1_" ]]
      then
          psvar[2]="$vcs_info_msg_1_"
      elif [[ -n "$vcs_info_msg_2_" ]]
      then
          psvar[2]="$vcs_info_msg_2_"
      elif [[ -n `echo "$st" | grep "^Untracked"` ]]
      then
          psvar[2]="Untracked"
      else
          psvar[2]="Clean"
      fi
    fi
}

# バージョン管理されているディレクトリにいれば表示，そうでなければ非表示
#RPROMPT="%1(v|%F{green}%1v%f|)"
# &lt;-- USER
PROMPT='%F{cyan}[%n@%m${WINDOW:+[$WINDOW]} %.] %1(v|%F{yellow}%1v|)%2(v|(%2v) |)%{%(?.$fg[green].$fg[red])%}%(!.#.$)%{$reset_color%} '
RPROMPT=[%~]
SPROMPT='zsh: replace '\''%R'\'' to '\''%r'\'' ? [Yes/No/Abort/Edit] '

</samp><p>結構イケる。</p>
<!-- PBSEARCH_RESULT -->
        </article>
    </section>
    <footer id="InfoFooter">
      <ul>
        <li>© Masaki Haruka 2003.</li>
        <li>Generated by <a href="https://gitlab.com/reasonset/pbsimply-wpimporter">PureBuilder Simply WP Importer</a></li>
      </ul>
    </footer>
  </body>
</html>
