<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="PureBuilder Simply WP Importer" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
    <meta name="author" content="Masaki Haruka" />
    <meta name="date" content="2017-06-16T00:00:00+09:00" />
    <meta name="dcterms.date" content="2017-06-16T00:00:00+09:00" />
    <title>Blink系ブラウザのSEGV(Core Dump, Memory Corruption)について - Chienomi</title>
    <style type="text/css">article {
max-width: 1080px;
margin: auto;
}</style>
  </head>
  <body>

    <section id="ContentContainer">
      <header id="MainHeader"><a href="/"><h1>Chienomi</h1></a></header>
      <section id="ArticleBox">
        <header id="ArticleTitle"><h1>Blink系ブラウザのSEGV(Core Dump, Memory Corruption)について</h1></header>
        <article id="MainArticle">
<p>Linux上で特定のユーザーにおいてBlink系のブラウザ(Chromium, Opera, Vivaldi等)全てでページクラッシュする、という問題に遭遇している。</p>
<p>この問題は「再現したもの」だか、再現が不定で、特定には至っていない。</p>
<p>状況としては、いずれのブラウザにおいてもページクラッシュを発生する。発生しやすいページはある(最も発生しやすいのはねとらぼであり、Facebookも非常に発生しやすい)が、常に発生するわけではなく、F5連打で解消することもある。 発生タイミングも一定ではなく、すぐにクラッシュすることもあれば、閲覧している間にクラッシュすることもあるし、操作中にクラッシュすることもある</p>
<p>クラッシュメッセージは以下。</p>
<pre><code>../../third_party/tcmalloc/chromium/src/free_list.h:118] Memory corruption detected. 
Received signal 11 SEGV_MAPERR 000000000039
#0 0x563bd9056f06 &lt;unknown&gt;
#1 0x563bd90572b9 &lt;unknown&gt;
#2 0x2af9899f3940 &lt;unknown&gt;
#3 0x563bd7695660 &lt;unknown&gt;
#4 0x563bd7698f62 &lt;unknown&gt;
#5 0x563bdd769f4a &lt;unknown&gt;
#6 0x563bd90e52f9 malloc
#7 0x563bd95f1019 &lt;unknown&gt;
#8 0x563bd9817c22 &lt;unknown&gt;
#9 0x563bd9817f14 &lt;unknown&gt;
#10 0x563bd96a3348 &lt;unknown&gt;
#11 0x563bd96a3617 &lt;unknown&gt;
#12 0x563bd96a4112 &lt;unknown&gt;
#13 0x563bd96a4d13 &lt;unknown&gt;
#14 0x563bd96a5542 &lt;unknown&gt;
#15 0x563bd9648996 &lt;unknown&gt;
#16 0x563bd960b2a4 &lt;unknown&gt;
#17 0x563bd9691067 &lt;unknown&gt;
#18 0x563bd981f3ed &lt;unknown&gt;
#19 0x563bd960f5e5 &lt;unknown&gt;
#20 0x563bd960f69d &lt;unknown&gt;
#21 0x563bd9ca0268 &lt;unknown&gt;
#22 0x563bd9c9f1bb &lt;unknown&gt;
#23 0x563bd9ca0c6b &lt;unknown&gt;
#24 0x563bd9ca0fad &lt;unknown&gt;
#25 0x563bd9ca07db &lt;unknown&gt;
#26 0x563bd9ca3fbe &lt;unknown&gt;
#27 0x563bd9ca2e0f &lt;unknown&gt;
#28 0x563bd9ca34f3 &lt;unknown&gt;
#29 0x563bd9ca3639 &lt;unknown&gt;
#30 0x563bd9cd4664 ../../third_party/tcmalloc/chromium/src/free_list.h:118] Memory corruption detected. </code></pre>
<p>このバグのややこしさは以下の通りだ</p>
<ul>
<li>特定ユーザーでしか発生しない</li>
<li>ユーザー固有のファイルを全て削除しても発生する</li>
<li>システムを再インストールした場合でもホームディレクトリを全て書き戻すと発生する</li>
<li>プロファイルやソフトウェアに関係なく発生する</li>
<li>発生していないユーザーを、ファイルリネームと<code>vipw</code>を使ってすり替えても発生する</li>
<li>特定ユーザー固有のこととして、ホームディレクトリ以下に別ファイルシステム(btrfs)をマウントしているが、straceで見てもそのファイルシステムへのアクセスはない</li>
<li>再現条件がランダムに見える</li>
<li>この事象自体は以前にも発生したことがある</li>
</ul>
<p>トレースログを見ても解決にはつながらず、かなりお手上げである。</p>

<!-- PBSEARCH_RESULT -->
        </article>
    </section>
    <footer id="InfoFooter">
      <ul>
        <li>© Masaki Haruka 2003.</li>
        <li>Generated by <a href="https://gitlab.com/reasonset/pbsimply-wpimporter">PureBuilder Simply WP Importer</a></li>
      </ul>
    </footer>
  </body>
</html>
