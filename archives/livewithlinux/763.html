<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="PureBuilder Simply WP Importer" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
    <meta name="author" content="Masaki Haruka" />
    <meta name="date" content="2015-10-13T00:00:00+09:00" />
    <meta name="dcterms.date" content="2015-10-13T00:00:00+09:00" />
    <title>ThinkPad e440 * Linuxの長い戦い - Chienomi</title>
    <style type="text/css">article {
max-width: 1080px;
margin: auto;
}</style>
  </head>
  <body>

    <section id="ContentContainer">
      <header id="MainHeader"><a href="/"><h1>Chienomi</h1></a></header>
      <section id="ArticleBox">
        <header id="ArticleTitle"><h1>ThinkPad e440 * Linuxの長い戦い</h1></header>
        <article id="MainArticle">
<ul id="markdown-toc">
  <li><a href="#section" id="markdown-toc-section">何を導入する？</a></li>
  <li><a href="#section-1" id="markdown-toc-section-1">セットアップ</a></li>
  <li><a href="#uim" id="markdown-toc-uim">uim</a></li>
  <li><a href="#sudo" id="markdown-toc-sudo">sudoは</a></li>
  <li><a href="#section-2" id="markdown-toc-section-2">サスペンド/ハイバネーション</a></li>
  <li><a href="#window-decorations" id="markdown-toc-window-decorations">Window decorationsをいじるとまずい</a></li>
</ul>

<h3 id="section">何を導入する？</h3>

<p>e440の構成は以前はWindows 7とPCLinuxOSのデュアルブートだった。
その前はSabayon Linuxで、結構安定していたのだが、使いにくい部分があり、PCLinuxOSとなった。</p>

<p>これが潰されたのは、Windows 7の書き戻しのためだ。</p>

<p>その後、時間がなかったため放置され、今回再編成に伴ってWindows 7はそのまま修正することが決まったため、Linuxを導入することになった。</p>

<p>ところが、これが辛い道のりだった。</p>

<p>望ましい構成は</p>

<ul>
  <li>sda1 Windows booy</li>
  <li>sda2 Windows System</li>
  <li>sda3 /boot</li>
  <li>sda4 Extended</li>
  <li>sda5 truecrypt</li>
  <li>sda6 LUKS LVM PV</li>
</ul>

<p>というものなのだが、このためには</p>

<ol>
  <li>/bootにPBRとしてGrubを導入できる</li>
  <li>手動パーティショニングができる</li>
  <li>LUKS上にLVM PVが作成できる</li>
</ol>

<p>という条件を満たす必要がある。
ところが、個々には一般的なことであるにもかかわらず、要件を満たすインストーラがない</p>

<ul>
  <li>Manjaro Thus : PBRインストール、LVMに対応しない。crypt swapでエラーとなる</li>
  <li>Manjaro Calamares : LUKSに対応しない</li>
  <li>Manjaro CLI Installer : UUIDで設定するが見つけられずエラーになる</li>
  <li>Linux Mint : LVMに対応しない。複数のcryptデバイスを設定できない</li>
  <li>openSUSE : PBRへのGrubインストールを無視する、エラー多数でうまく動作しない</li>
</ul>

<p>困り果ててしまった。
途中、諦めてPCLinuxに戻ったりもしたのだが、AddLocaleが正常に動作せず、ほかを試し、結局3日ほどかかった。</p>

<p>この要件、自動インストールであればちゃんと動作するのだが、手動だとなかなか動かない。
インストーラの品質は難しいところなのか。</p>

<p>ちなみに、Manjaro 0.8.13においては、WiFiが接続はできるが、通信しているとストールしてしまうという問題も発生した。</p>

<h3 id="section-1">セットアップ</h3>

<p>結局うまくいったのはPCLinuxOSだった。(Reiser4が使えなかったりはした)
AddLocale周りの設定は、手順としては(@PCLOS 2014.12 KDE)</p>

<ol>
  <li>インストール</li>
  <li>初期設定</li>
  <li>アップデートとアップグレード</li>
  <li>再起動</li>
  <li>Localization ManagerからのAddLocale</li>
  <li>リポジトリをJAISTに変更し、<a href="http://tomcat.nyanta.jp/sb2/infomation.html#norarepo">Tomcatさんのリポジトリを追加</a>する。パッケージリストはリロードしておく。</li>
  <li>アップグレードしておく</li>
  <li>gsetime(入力メソッドの選択)でIMEにuimを選択する。uimは私の好みなのでscimやfcitxにしても構わない。i-busを使用する場合はTomcatさんのリポジトリの追加を忘れない</li>
</ol>

<p>なお、解像度がどうしてもXGAになってしまうため、PCLinuxOS Control Centerで設定しておく。KDEの設定で設定しても再起動時には戻ってしまう。</p>

<h3 id="uim">uim</h3>

<p>uimを選択したのは、元より日本人が日本語入力のために制作したもの(SCIMやfcitxは日本語のために作られたわけではない)であり、非常に軽量でセキュアだ。シンプルだが、「日本語を入力する」という観点から言えば最高だと思っている。</p>

<p>残念ながら開発が停滞し、国際的にも支持されていないことから消えそうになっている。
日本でもMozcがuimが使えない(そもそも、人気の高いUbuntuやFedoraが国際的なものでSCIM, i-bus, fcitxなどを採用する)といったことで使われなくなってしまっている。</p>

<p>SCIMやi-busと比べ、安定していて高機能なfcitxにさほど不満はないが、やはり私はuimが好きだ。</p>

<p>PCLinuxOSのIMEは、MozcにせよAnthyにせよ、入力効率は非常に悪い。
しかし、Tomcatさんのリポジトリを追加することで、入力効率に優れたかな漢字変換を使用することができるようになる。</p>

<p>野良版のuim関連のパッケージを一通り入れても、UIM appletは起動しない。
だが、<code>uim-toolbar-gtk</code>及び<code>uim-toolbar-gtk3</code>は存在するため、これを自動起動に追加すれば動作するようになる。</p>

<p>uimはWeb変換サービスに対応している。
Ubuntuにも<code>uim-google-cgiapi-jp</code>, <code>uim-baidu-olime-jp</code>, <code>uim-social-ime</code>, <code>uim-ajax-ime</code>, <code>uim-yahoo-jp</code>のパッケージが用意されている。
野良版uimはこれらも既にセットアップされた状態で提供される。</p>

<p>なお、uimだとkkcは利用できない。
kkc愛好家(いるのか?)の方はfcitxを使用すること。</p>

<p>野良版uimだと、公式のfcitx-mozcで生じるかな入力において「ー」が「ろ」になる問題、fcitx-anthyで逆に「ろ」が「ー」になる問題は解決されている。</p>

<h3 id="sudo">sudoは</h3>

<p>sudoはi586版だとspecialにあるが、x86_64版は普通にある。</p>

<h3 id="section-2">サスペンド/ハイバネーション</h3>

<p>e440だとサスペンド(スリープ)/ハイバネーションできない。ずっとファンが回っていてハードディスクの音がしているので、復帰できないのではなく、サスペンドに入れないのか。</p>

<h3 id="window-decorations">Window decorationsをいじるとまずい</h3>

<p><a href="https://bugs.kde.org/show_bug.cgi?id=333727">KDEのBTSにも記載がある</a>けれど、ウィンドウの装飾を変更するとKDEが起動しなくなる。</p>

<p><code>~/.kde4/share/config/auroraerc</code>をトバすだけでは解決しないため、かなり厄介な問題になる。要注意。</p>

<!-- PBSEARCH_RESULT -->
        </article>
    </section>
    <footer id="InfoFooter">
      <ul>
        <li>© Masaki Haruka 2003.</li>
        <li>Generated by <a href="https://gitlab.com/reasonset/pbsimply-wpimporter">PureBuilder Simply WP Importer</a></li>
      </ul>
    </footer>
  </body>
</html>
