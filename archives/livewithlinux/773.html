<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="PureBuilder Simply WP Importer" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
    <meta name="author" content="Masaki Haruka" />
    <meta name="date" content="2015-10-28T00:00:00+09:00" />
    <meta name="dcterms.date" content="2015-10-28T00:00:00+09:00" />
    <title>ManjaroでCinnamonが破損 + Plasmaのセットアップ - Chienomi</title>
    <style type="text/css">article {
max-width: 1080px;
margin: auto;
}</style>
  </head>
  <body>

    <section id="ContentContainer">
      <header id="MainHeader"><a href="/"><h1>Chienomi</h1></a></header>
      <section id="ArticleBox">
        <header id="ArticleTitle"><h1>ManjaroでCinnamonが破損 + Plasmaのセットアップ</h1></header>
        <article id="MainArticle">
<ul id="markdown-toc">
  <li><a href="#cinnamon" id="markdown-toc-cinnamon">Cinnamonが起動しない</a></li>
  <li><a href="#plasma-workspace" id="markdown-toc-plasma-workspace">Plasma Workspace</a></li>
  <li><a href="#systray" id="markdown-toc-systray">Systray問題</a></li>
  <li><a href="#wineline" id="markdown-toc-wineline">WINEにおけるLINEのフォントの問題</a></li>
</ul>

<h3 id="cinnamon">Cinnamonが起動しない</h3>

<p>Manjaro 2015-10-19 Stableを適用後の2015-10-22に、Cinnamonが起動しない、というトラブルに見舞われた。
正確には起動はしているように見えるのだが、表示されない。マウスカーソルがウィンドウ位置に合わせて変わるものの、一切の表示がない。</p>

<p>別ユーザーでも生じるため、自力で解明できず、結局Manjaro Forumに助けを乞うこととなった。</p>

<p>crazyg4merzさんにお答えいただき解決した。</p>

<p>2015-10-21に追加でアップデートされたcoglパッケージ(cogl-1.22.0-1.1-x86_64)がダメであったらしい。
これがDEを破壊する毒入りパッケージであったということだ。</p>

<pre><code>sudo pacman -U /var/cache/pacman/pkg/cogl-1.22.0-1-x86_64.pkg.tar.xz
</code></pre>

<p>で解決した。</p>

<h3 id="plasma-workspace">Plasma Workspace</h3>

<p>Cinnamonが起動しない間、Plasma 5を使っていた。</p>

<p>ManjaroにPlasma 5がきたばかりの頃は、Plasma Workspaceコンポーネンツ自体のエラーが非常に多く、使い物にならなかった。</p>

<p>そこからすればだいぶ安定したとは思うが、まだkAlarmなど勝手に落ちるプログラムは多い。
また、kcmの内容をみても、まだまだKDE4の品質には追い付いていない、という印象だ。</p>

<p>とはいえ、追加された機能もあり、「完全に機能すれば」かなり素晴らしいDEであるとは思う。
UI自体はPlasma 5よりものしぃKDE 4のほうが好きだし、KDE 3はもっと好きだが。</p>

<p>Plasma 5で追加された機能のうち、私にとって重要だったのは、QuicktileにTopとBottomが追加されたことだ。
これまでは四隅と左右の6方向だったが、ようやくCinnamon同様に8方向に対するタイリングが可能になった。</p>

<p>このほか、強化された点を含め、Plasma 5の魅力が</p>

<ul>
  <li>通知が制限された多段で表示される。Cinnamonは通知がひとつずつなので通知に領域を占領されてしまうし、XFceは大量に表示されてしまいデスクトップがうめつくされてしまう。</li>
  <li>8方向にタイルできる</li>
  <li>KDE関連のアプケーションを含めて統合的にショートカットを設定できる</li>
  <li>リマインダ機能がある</li>
  <li>KDEに統合されているアプリケーションは非常に便利に使うことができる。</li>
  <li>通知領域への表示・非表示が任意に設定できる</li>
  <li>DPI設定を忠実に反映してくれる(UIも含めて)</li>
  <li>タスクスイッチャに使いやすいBreezeがある</li>
</ul>

<p>Cinnamonのほうがいいのが</p>

<ul>
  <li>通知の非表示が可能</li>
  <li>PulseAudioアプレットの機能が貧弱</li>
  <li>systrayでなくsniによる実装で、systrayに入ってくれなかったりする</li>
  <li>WINEの文字表示が汚い</li>
  <li>全体にフォントレンダリングがCinnamonのほうが綺麗</li>
</ul>

<p>SylpheedとTomboyを使っているが。KMailとKOrganizerを使っていたらもっと便利だろうと思う。</p>

<h3 id="systray">Systray問題</h3>

<p><code>xembed-sni-proxy</code>をインストールし、起動すれば解決するといえばするが、アイコンが表示されない。</p>

<p>私はTrayerを使い</p>

<pre><code>trayer --edge bottom --align right --widthtype request 
</code></pre>

<p>のようにしている。右下にしているのは、デュアルディスプレイだから。
ちなみに、Trayerは領域を確保せず、stalonetrayは確保する。
最大化した時にかぶるかどうかが違う。</p>

<p>タスクマネージャを外してtintを使う、というのも方法かもしれない。</p>

<h3 id="wineline">WINEにおけるLINEのフォントの問題</h3>

<p>XFceでもPlasmaでもWINEのLINEの文字は汚い、というかCinnamon/GNOMEだけが綺麗に表示できる。</p>

<p>XFce, PlasmaはWindowsっぽいレンダリング(むしろビットマップっぽい)、CinnamonとGnomeは通常通りInfinarityのそれだ。</p>

<p>しかも、PlasmaやXFceにおいては、フォント幅が適切に保たれず、フォントが重なって欠けて見えるため可読性が非常に低い。</p>

<p>これについては、<code>regedit.exe</code>で<code>HKEY_CURRENT_USER\Control Panel\Desktop</code>以下</p>

<pre><code>FontSmoothing REG_SZ 2
FontSmoothingGamma REG_DWORD 0x000003e8(1000)
FontSmoothingOrientation REG_DWORD 0x00000001(1)
FontSmoothingType REG_DWORD 0x00000002(2)
</code></pre>

<p>のように設定。これで幅は確保される。
だが、アンチエイリアスは効かないので、<code>HKEY_CURRENT_USER\Software\Wine\X11 Driver\ClientSideWithRender</code>という値を作る。これできくようになる。</p>

<p>ただ、英字フォントについてはAAが効かないので違和感は結構ある。
これは、regeditの表示など、LINE以外のいくつかにも有効に働き、そこでは英字に対してもきいている。
しかし、Freetypeのものと比べると随分汚い。</p>

<p>色々ためしてみたのだが、うまく行かなかった。</p>

<!-- PBSEARCH_RESULT -->
        </article>
    </section>
    <footer id="InfoFooter">
      <ul>
        <li>© Masaki Haruka 2003.</li>
        <li>Generated by <a href="https://gitlab.com/reasonset/pbsimply-wpimporter">PureBuilder Simply WP Importer</a></li>
      </ul>
    </footer>
  </body>
</html>
