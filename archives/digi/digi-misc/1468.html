<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="PureBuilder Simply WP Importer" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
    <meta name="author" content="Masaki Haruka" />
    <meta name="date" content="2018-07-16T00:00:00+09:00" />
    <meta name="dcterms.date" content="2018-07-16T00:00:00+09:00" />
    <title>Lenovo ThinkStation P720 に Windows 7 をインストールする - Chienomi</title>
    <style type="text/css">article {
max-width: 1080px;
margin: auto;
}</style>
  </head>
  <body>

    <section id="ContentContainer">
      <header id="MainHeader"><a href="/"><h1>Chienomi</h1></a></header>
      <section id="ArticleBox">
        <header id="ArticleTitle"><h1>Lenovo ThinkStation P720 に Windows 7 をインストールする</h1></header>
        <article id="MainArticle">
<h2 id="なんとかしてp720でwindows-7を使う">なんとかしてP720でWindows 7を使う</h2>
<p>私が音楽のお仕事するときの環境は以前としてその中核にSONAR X3が据えられているため、Windows 7が欠かせない。</p>
<p>ThinkStation P720は将来性を考えてWindows 10モデルを選択したが、手元にあるリテール版Windows 7 Professionalのライセンスを利用してWindows 10, Windows 7, そしてLinuxという構成にするのが私の目論見であった。</p>
<p>Skylake-SPプロセッサはWindows 7を使うことができる最強にして最終のプロセッサである。</p>
<p>だが、これはかなりの困難に阻まれた。</p>
<p>もちろん、Windows 10は(いささかの問題はあれど)動作するし、Linuxもなんら問題はない。 だが、Windows 7に関してはインストールディスクから起動すると “Starting Windows” の表示と共に停止してしまうのだ。</p>
<p>様々なトライをしたがうまくいかず、Windows Updateを適用したディスクの作成を試みた。</p>
<p>内容としては<a href="https://9bo.hateblo.jp/entry/2017/03/26/235115">ここ</a>や<a href="http://blog.techlab-xe.net/archives/5676">ここ</a>を参考にしたが、そのままは適用できなかった。 特にIE11関連はアップデートの配布がされていなかった。</p>
<p>とはいえおおよそ必要と思われるものを統合した。</p>
<p>だが、これでも問題が発生した。</p>
<p>Legacy (BIOS) なら起動できるのだが、UEFIだとUEFIアプリケーションを見つけてもらえない。 bootx64.efiの用意もしたのにだ。</p>
<p>調べたり質問したりしたのだが、解決には至らなかったので、結局UEFI Onlyでの運用を諦めてハイブリッドブートとした。</p>
<p>さて、これでインストーラが起動するようになったのだが、残念ながらUSB2.0ポートにつなぐ場合(P720はキーボード/マウス用ポートのみがUSB2.0)を含めてUSBデバイスが一切反応しない。</p>
<p>幸いにもPS/2ポートが存在しているので、これを利用する。PS/2-USBアダプタは機能しなかったため、PS/2キーボードを新規に購入した。</p>
<p>これでWindows 7は起動するのだが、まともに動かない。 とにかくドライバがない。そして何も動かない。</p>
<p>仕方ないので別のマシンから <a href="https://support.lenovo.com/jp/en/downloads/ds501864">SCCM Packages For Windows 7 (64-bit) - ThinkStation P720, P920</a> をゲットして、CD-Rに焼いて展開する。</p>
<p>そう、USBもイーサネットコントローラも動作しないのでCD-Rだけが頼りなのだ。</p>
<p>この状態で<code>C:\DRIVERS</code>以下にドライバファイルが配置された状態になるので、デバイスマネージャからドライバの場所の指定でここを指定すればインストールできるようになる。</p>
<p>大量の動作しないデバイスがあるためかなり大変な作業である。</p>
<figure><a href="/wp-content/uploads/2018/07/windows7-installed-on-p720.png"><img src="/wp-content/uploads/2018/07/windows7-installed-on-p720.png" alt="" width="800" height="600" class="size-full wp-image-1467" /></a><figcaption> Windows 7をP720にインストールした状態</figcaption></figure>
<p>とりあえず2つのネットワークコントローラとUSB(4つある)をインストールすればWindows Updateもできるようになり、楽な進行になるだろう。 USB3.0ルートハブにUSB2.0ハブがぶら下がっている格好であるためUSBマウスが動作しなかったのだが、USB2.0ハブのほうもWindows 7はドライバーを持っていなかった。</p>
<p>実際は全部をインストールしなくてもよかった(ある段階でCPU内蔵機能に関しては残りすべて導入されていた)が、Windows Updateと並行するのでなかなか複雑なことになる。</p>
<p>注意点としては、「Blink系ブラウザはシステムがフリーズする」。 原因はわからないが、とりあえずブラウザはFirefoxに限る、ということになりそうだ。導入作業でChrome, Vivaldi, Sleipnirなどを使って作業しようとするとハマることになる。</p>
<h2 id="windows-7-は動いたが断念せざるをえず">Windows 7 は動いたが、断念せざるをえず</h2>
<p>「特定のタイミングでフリーズする」という問題が「ASIOなどでの音声再生時」に発生したことが致命的で、どうすることもできないので断念することとなった。</p>
<p>そもそもWindowsは音楽制作専用である。他にWindowsを使う機会はない。 厳密に言えばそこから派生した作業もWindowsですることになるが、中核になるのは音楽制作であり、それがなければWindowsはいっそなくても構わない。</p>
<p>だからASIOでの音声再生でフリーズする、というのは音楽制作に使用できないということであり、私としては全く価値がない。</p>
<p>記事としては「Windows 10 プリインストールなP720でWindows 7を動かす」というテーマだからここから先は重要ではないとも言えるんだけど、私としては10日程度を無駄に費やしてここからがスタート地点ということになる。</p>
<p>とりあえずDTM系ソフトウェアは2台に対してアクチベーションが可能なものが多いので、P720 Windows 7は諦めて、 Z400 Windows 7とP720 Windows 10に対して構築していく方針としている。</p>
<p>P720のWindows 7もASIOで落ちたりしていたのだが、アップデートで落ち着いたようだ。</p>
<p>SONAR X3は残念ながらWindows 10では動かない部分がある。 D-Proが動かなかったような気がする…D-Proは私の主力なのでなくなると大変痛い。</p>
<p>(D-ProはどのみちSONAR以外では利用できないようになっている)</p>
<p>DTMの話は続きとして書いていたのだが、主旨の全く異なる話になったため、分割する。</p>

<!-- PBSEARCH_RESULT -->
        </article>
    </section>
    <footer id="InfoFooter">
      <ul>
        <li>© Masaki Haruka 2003.</li>
        <li>Generated by <a href="https://gitlab.com/reasonset/pbsimply-wpimporter">PureBuilder Simply WP Importer</a></li>
      </ul>
    </footer>
  </body>
</html>
