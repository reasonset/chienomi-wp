<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="PureBuilder Simply WP Importer" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
    <meta name="author" content="Masaki Haruka" />
    <meta name="date" content="2018-07-29T00:00:00+09:00" />
    <meta name="dcterms.date" content="2018-07-29T00:00:00+09:00" />
    <title>ConoHaのCPUは本当に速いのか試してみた - Chienomi</title>
    <style type="text/css">article {
max-width: 1080px;
margin: auto;
}</style>
  </head>
  <body>

    <section id="ContentContainer">
      <header id="MainHeader"><a href="/"><h1>Chienomi</h1></a></header>
      <section id="ArticleBox">
        <header id="ArticleTitle"><h1>ConoHaのCPUは本当に速いのか試してみた</h1></header>
        <article id="MainArticle">
<p>ConoHaの5周年イベントで<a href="https://twitter.com/hironobu_s">@hironobu_s</a>さんが「ConoHaはCPUが速いので」という話をしていたので、「本当に速いんだったら使いみちが増えるなぁ」と思って試してみた。</p>
<p>だいたいこういうときはLinuxカーネルをビルドするものだけど、それはちょっと私のConoHaインスタンスには辛いものがあるので、zsh-gitをビルドしてみた。 ビルドはzsh-gitを一旦ビルドしたあと、パッケージを削除して再度<code>makepkg</code>する方式だ。</p>
<p>1GBしかメモリのないConoHaではtmpfsに置くのは難しいため、公平を期すためストレージ上に配置してビルドした。 ただし、Proliantに関してはIDE HDDで低速であるため、tmpfs上に置くこととした。</p>
<table>
<colgroup>
<col style="width: 11%" />
<col style="width: 19%" />
<col style="width: 9%" />
<col style="width: 13%" />
<col style="width: 45%" />
</colgroup>
<thead>
<tr class="header">
<th>マシン</th>
<th>CPU</th>
<th>メモリ</th>
<th>ストレージ</th>
<th>結果</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ThinkStation P720 (Performance)</td>
<td>Xeon Silver 4114 *2</td>
<td>16GB DDR4</td>
<td>(tmpfs)</td>
<td>58.85s user 16.15s system 63% cpu 1:57.77 total</td>
</tr>
<tr class="even">
<td>ConoHa</td>
<td>-</td>
<td>1GB</td>
<td>SSD Vdisk</td>
<td>68.20s user 18.65s system 67% cpu 2:08.76 total</td>
</tr>
<tr class="odd">
<td>ThinkPad X1 Carbon</td>
<td>Core i5-7200U</td>
<td>8GB DDR4</td>
<td>SATA3 SSD +LUKS</td>
<td>85.58s user 31.33s system 73% cpu 2:38.57 total</td>
</tr>
<tr class="even">
<td>自作</td>
<td>A10 7870K</td>
<td>32GB DDR3</td>
<td>SATA3 SSD +LUKS</td>
<td>86.29s user 27.51s system 73% cpu 2:34.90 total</td>
</tr>
<tr class="odd">
<td>Z400</td>
<td>Xeon W3565</td>
<td>20GB DDR3</td>
<td>SATA2 SSD +LUKS</td>
<td>94.57s user 27.29s system 74% cpu 2:44.22 total</td>
</tr>
<tr class="even">
<td>ThinkStation P720</td>
<td>Xeon Silver 4114 *2</td>
<td>16GB DDR4</td>
<td>NVMe SSD +LUKS</td>
<td>101.57s user 49.95s system 80% cpu 3:08.84 total</td>
</tr>
<tr class="odd">
<td>Proliant microserver</td>
<td>Turion II Neo N54L</td>
<td>4GB DDR3</td>
<td>(tmpfs)</td>
<td>146.95s user 46.53s system 84% cpu 3:50.16 total</td>
</tr>
</tbody>
</table>
<p>えぇぇぇ…</p>
<p>まず、超高性能マシンであるところのP720が異様に遅い。 CPU利用率は高くても8%、周波数は800MHzのままで、凄まじい余裕を見せつける…のはいいけれど、とにかく遅い。</p>
<p>そこでもう我慢ならぬと<code>cpupower frequency-set -g performance</code>してtmpfsを解禁してやってみた結果が1位のものだ。 この場合でもCPU利用率は0.5%未満で、辛いものがある。</p>
<p>さて、X1 Carbonが積んでいるのは前世代のCore i5で、ラップトップとしては標準的な性能といっていいと思う。 A10 7870Kは今のデスクトップ用Core i3と同じくらい、Xeon W3565もだいたい同じ感じだ。</p>
<p>この感じだとConoHaと同等というと、6コアのi7でないと厳しいのではないか、というくらいConoHaが速い。</p>
<p>P720とProliantが採用するのはサーバー用プロセッサだ。ProliantのTurionは激安サーバーに使われているもので、イマドキちょっと見ない。 一方、P720が使用しているのは最新のサーバー用プロセッサで、4114を2基搭載するサーバーというと、結構な高級サーバーである。例えばHPE ProLiant DL360 Gen10がXeon Silver 4114 *2という構成だが、776,000円である。</p>
<p>つまりConoHaはちょっと自分では持つのは厳しいコンピュータくらいの性能がある。 コンピュータがマニアックな趣味の人でなければちょっと買えない、実用的なコストパフォーマンス的には買わないようなコンピュータ並の計算力を持っているということになる。</p>
<p>これまでConoHaが「あれ、なんか速いな」と思うことはあったのだが、それでもそんなに計算リソースが割り当てられているとは思っていなかったので、あまり負担をかけないようにしていた。 ぶっちゃけ、AURパッケージはローカルでビルドしてパッケージをアップロードしていたくらいだ。</p>
<p>しかしここまで速いと、AURパッケージのビルドくらいなんということはない(メモリ的に厳しいところもあるが)、どころか、「計算用のノードとしてConoHaインスタンスを立てる」ということが成り立つレベルである。</p>
<p>こうなると使いようがすごく広がるし、感覚的にも全然違う。</p>
<p>おみそれしました…</p>

<!-- PBSEARCH_RESULT -->
        </article>
    </section>
    <footer id="InfoFooter">
      <ul>
        <li>© Masaki Haruka 2003.</li>
        <li>Generated by <a href="https://gitlab.com/reasonset/pbsimply-wpimporter">PureBuilder Simply WP Importer</a></li>
      </ul>
    </footer>
  </body>
</html>
